(function(a){var e=a.ephox=a.ephox||{};var d=e.bolt=e.bolt||{};var b=function(g,f){return f.apply(null,g)};var c=d.kernel=d.kernel||{};c.api=c.api||{};c.async=c.api||{};c.fp=c.fp||{};c.modulator=c.modulator||{};c.module=c.module||{};c.fp.array=b([],function(){var i=function(p,o){if(p.length!==o.length){return false}for(var q=0;q<p.length;++q){if(p[q]!==o[q]){return false}}return true};var l=function(o,r){var q=r||function(s){return s===true};for(var p=0;p<o.length;++p){if(q(o[p])!==true){return false}}return true};var g=function(o,s){var q=[];for(var p=0;p<o.length;++p){q.push(s(o[p],p))}return q};var f=function(o){var q=[];for(var p=0;p<o.length;++p){q=q.concat(o[p])}return q};var n=function(o,p){return f(g(o,p))};var h=function(o,s){var q=[];for(var p=0;p<o.length;++p){if(s(o[p])){q.push(o[p])}}return q};var m=g;var j=function(p,o){return !l(p,function(q){return q!==o})};var k=function(p,o){for(var q=0;q<p.length;++q){if(p[q]===o){return q}}return -1};return{equals:i,forall:l,map:g,flatten:f,flatmap:n,filter:h,each:m,contains:j,indexof:k}});c.fp.object=b([],function(){var h=function(m,l){var k={};for(var j in m){if(m.hasOwnProperty(j)){k[j]=l(j,m[j])}}return k};var g=h;var i=function(k,j){g(j,function(m,l){k[m]=l})};var f=function(k){var j=[];g(k,function(l){j.push(l)});return j};return{each:g,keys:f,map:h,merge:i}});c.fp.functions=b([],function(){var g=function(j){var k=Array.prototype.slice;var i=k.call(arguments,1);return function(){var l=i.concat(k.call(arguments,0));return j.apply(null,l)}};var h=function(i){return function(){var j=Array.prototype.slice;return !i.apply(null,j.call(arguments,0))}};var f=function(i){var j=Array.prototype.slice;return i.apply(null,j.call(arguments,0))};return{curry:g,not:h,apply:f}});c.async.map=b([c.fp.array],function(f){var g=function(m,l,i){var k=m.length;var j=0;var h=[];f.each(m,function(n,o){l(n,function(p){++j;h[o]=p;if(j===k){i(h)}})})};return{amap:g}});c.async.piggybacker=b([c.fp.array,c.fp.functions],function(f,h){var g=function(){var i={};var j=function(l){var m=i[l];delete i[l];f.each(m,h.apply)};var k=function(l,n,m){if(i[l]===undefined){i[l]=[m];n(h.curry(j,l))}else{i[l].push(m)}};return{piggyback:k}};return{create:g}});c.modulator.globalator=b([],function(){var f=function(){var j=function(k,m){var o=k.split(".");var n=m;for(var l=0;l<o.length&&n!==undefined;++l){n=n[o[l]]}return n};var i=Function("return this")();var h=function(k){return k.indexOf("global!")===0};var g=function(o,n,l){var k=o.substring("global!".length);var m=function(q,r){var p=j(k,i);if(p!==undefined){n(o,[],function(){return p});q()}else{r("Modulator error: could not resolve global ["+k+"]")}};return{url:o,load:m,serial:true}};return{can:h,get:g}};return{create:f}});c.modulator.bolt=b([c.fp.functions],function(g){var f=function(h,k,l,n,o,j){var m=function(p){return p===l||p.indexOf(l+".")===0||p.indexOf(l+"/")===0};var i=function(t){var r=j!==undefined&&j.absolute===true?n:k(n);var s=j!==undefined&&j.fresh===true?"?cachebuster="+new Date().getTime():"";var p=r+"/"+o(t)+".js"+s;var q=g.curry(h.load,p);return{url:p,load:q,serial:false}};return{can:m,get:i}};return{create:f}});c.module.stratifier=b([c.fp.array],function(g){var f=function(i){var h=g.filter(i,function(j){return !j.serial});return h.length>0?h:i.slice(0,1)};return{stratify:f}});c.module.analyser=b([c.fp.array],function(h){var g=function(m,j){var k=h.indexof(m,j);var l=m.slice(k);return l.concat([j])};var f=function(q,j){var l={};var s=[];var n=[];var k;var i=function(t){h.each(j[t],m)};var r=function(t){if(j[t]){i(t)}else{n.push(t)}};var p=function(t){s.push(t);r(t);s.pop()};var o=function(t){if(h.contains(s,t)){k=g(s,t)}else{p(t)}};var m=function(t){if(!l[t]){o(t);l[t]=true}};h.each(q,m);return k?{cycle:k}:{load:n}};return{analyse:f}});c.module.fetcher=b([c.fp.array,c.fp.functions,c.async.map,c.async.piggybacker,c.module.stratifier],function(f,i,j,k,g){var h=function(v,n,q,p,o,t){var s=k.create();var r=function(w,y){var x=f.filter(y,i.not(n));if(x.length>0){q("Fetcher error: modules were not defined: "+x.join(", "))}else{w()}};var m=function(w,x){var z=i.curry(x,w.id);var y=function(A){w.load(A,q)};s.piggyback(w.url,y,z)};var u=function(z,w){var x=i.curry(r,w);var y=g.stratify(z);j.amap(y,m,x)};var l=function(x,w){v.regulate(x,p,o,t,function(y){u(y,w)},q)};return{fetch:l}};return{create:h}});c.module.loader=b([c.module.analyser],function(f){var g=function(k,n,m,l,j,i){var h=f.analyse(k,n);if(h.cycle){i("Dependency error: a circular module dependency exists from "+h.cycle.join(" ~> "))}else{if(h.load.length===0){j()}else{m.fetch(h.load,l)}}};return{load:g}});c.module.manager=b([c.fp.array,c.fp.object,c.module.loader,c.module.fetcher],function(g,j,f,i){var h=function(s,q){var o={};var n={};var p=function(w,v,u){if(w===undefined){q("Define error: module id can not be undefined")}else{if(o[w]!==undefined){q("Define error: module '"+w+"' is already defined")}else{o[w]={id:w,dependencies:v,definition:u}}}};var m=function(w,x){var u=function(){var y=g.map(w,r);x.apply(null,y)};var v=function(){var y=j.map(o,function(A,z){return z.dependencies});f.load(w,y,k,v,u,q)};v()};var r=function(v){if(n[v]!==undefined){return n[v]}if(o[v]===undefined){throw"module '"+v+"' is not defined"}var u=t(v);if(u===undefined){throw"module '"+v+"' returned undefined from definition function"}n[v]=u;return u};var t=function(w){var v=o[w];var u=g.map(v.dependencies,r);return v.definition.apply(null,u)};var l=function(u){return o[u]!==undefined};var k=i.create(s,l,q,p,m,r);return{define:p,require:m,demand:r}};return{create:h}});c.api.sources=b([c.fp.array,c.fp.object,c.modulator.globalator],function(f,i,h){var g=function(j,l){var n={global:{instance:h}};i.each(j,function(v,w){n[v]={instance:w}});f.each(l.types,function(v){n[v.type]={id:v.modulator}});var p=l.sources.slice(0);var k=[h.create()];var s=function(v){if(n[v]===undefined){throw"Unknown modulator type ["+v+"]."}};var r=function(v){s(v);return n[v].instance!==undefined};var o=function(v){s(v);return n[v].id};var m=function(v){s(v);return n[v].instance};var u=function(w,v){s(w);n[w].instance=v};var q=function(w){for(var v=0;v<k.length;++v){if(k[v].can(w)){return{found:k[v]}}}return{notfound:true}};var t=function(){var v=[];f.each(p,function(x){if(r(x.type)){var w=m(x.type);var y=w.create.apply(null,x.args);k.push(y)}else{v.push(x)}});p=v};return{isResolved:r,idOf:o,instanceOf:m,register:u,find:q,crank:t}};return{create:g}});c.api.regulator=b([c.fp.array,c.fp.functions],function(f,h){var g=function(j){var m=function(t,v,s,r,q,p){j.crank();var u=f.map(t,k);var o=f.filter(u,h.not(j.isResolved));if(o.length===0){l(t,v,s,r,q,p)}else{i(o,t,v,s,r,q,p)}};var l=function(q,v,t,y,z,w){var p=[];for(var u=0;u<q.length;++u){var s=q[u];var o=j.find(s);if(o.notfound){w("Could not find source for module ["+s+"]");return}var x=o.found.get(s,v,t,y);p[u]=n(s,x)}z(p)};var n=function(p,o){return{id:p,url:o.url,load:o.load,serial:o.serial}};var i=function(t,u,v,r,q,p,o){var s=f.map(t,j.idOf);r(s,function(){var w=arguments;f.each(t,function(y,x){j.register(y,w[x])});m(u,v,r,q,p,o)})};var k=function(p){var o=p.indexOf("!");return o===-1?"bolt":p.substring(0,o)};return{regulate:m}};return{create:g}});c.api.config=b([c.module.manager,c.api.regulator,c.api.sources],function(h,i,g){var f=function(o,n,j){var l=g.create(n,o);var m=i.create(l);var k=h.create(m,j);return{define:k.define,require:k.require,demand:k.demand}};return{configure:f}})})(Function("return this")());(function(scope){var ephox=scope.ephox=scope.ephox||{};var bolt=ephox.bolt=ephox.bolt||{};var def=function(deps,factory){return factory.apply(null,deps)};var loader=bolt.loader=bolt.loader||{};loader.executor=loader.executor||{};loader.api=loader.api||{};loader.transporter=loader.transporter||{};loader.tag=loader.tag||{};loader.tag.script=def([],function(){var guard=function(callback){return function(evt){if(evt.srcElement.readyState==="loaded"||evt.srcElement.readyState==="complete"){callback()}}};var ie=function(el){return el.attachEvent&&!window.opera};var onload=function(el,callback){if(ie(el)){el.attachEvent("onreadystatechange",guard(callback))}else{el.addEventListener("load",callback,false)}};var createtag=function(callback){var el=document.createElement("script");el.type="text/javascript";onload(el,callback);return el};var insert=function(decorator,callback){var el=createtag(callback);decorator(el);var head=document.getElementsByTagName("head")[0];head.appendChild(el)};return{insert:insert}});loader.transporter.commonjs=def([],function(){var read=function(url,success,error){var fs=require("fs");fs.exists(url,function(exists){if(exists){fs.readFile(url,"UTF-8",function(err,data){if(err){error("Error reading file ["+url+"], error ["+err+"]")}else{success(data)}})}else{error("File does not exist ["+url+"]")}})};return{read:read}});loader.transporter.xhr=def([],function(){var requestObject=function(){var factories=[function(){return new XMLHttpRequest()},function(){return new ActiveXObject("Microsoft.XMLHTTP")}];return fallback(factories)};var fallback=function(items){for(var i=0;i<items.length;++i){try{return items[i]()}catch(e){}}};var handler=function(req,url,success,error){return function(){if(req.readyState===4){done(req,url,success,error)}}};var done=function(req,url,success,error){if(req.status===200||req.status===304){success(req.responseText)}else{error("Transport error: "+req.status+" "+req.statusText+' for resource: "'+url+'"')}};var getUrl=function(req,url,success,error){req.open("GET",url,true);req.onreadystatechange=handler(req,url,success,error);req.send()};var request=function(url,success,error){var req=requestObject();if(req){getUrl(req,url,success,error)}else{error("Transport error: browser does not support XMLHttpRequest.")}};return{request:request}});loader.executor.evaller=def([],function(){var execute=function(data,onsuccess,onfailure){try{eval(data)}catch(e){onfailure(e);return}onsuccess()};return{execute:execute}});loader.executor.injector=def([loader.tag.script],function(script){var execute=function(data,onsuccess,onfailure){var inject=function(tag){tag.text=data};var noop=function(){};script.insert(inject,noop);onsuccess()};return{execute:execute}});loader.api.commonjsevaller=def([loader.transporter.commonjs,loader.executor.evaller],function(commonjs,evaller){var load=function(url,onsuccess,onfailure){var inject=function(data){evaller.execute(data,onsuccess,onfailure)};commonjs.read(url,inject,onfailure)};return{load:load}});loader.api.scripttag=def([loader.tag.script],function(script){var load=function(url,onsuccess,onfailure){var sourcer=function(tag){tag.src=url};script.insert(sourcer,onsuccess)};return{load:load}});loader.api.xhrevaller=def([loader.transporter.xhr,loader.executor.evaller],function(xhr,evaller){var load=function(url,onsuccess,onfailure){var inject=function(data){evaller.execute(data,onsuccess,onfailure)};xhr.request(url,inject,onfailure)};return{load:load}});loader.api.xhrinjector=def([loader.transporter.xhr,loader.executor.injector],function(xhr,injector){var load=function(url,onsuccess,onfailure){var inject=function(data){injector.execute(data,onsuccess)};xhr.request(url,inject,onfailure)};return{load:load}})})(Function("return this")());(function(scope){var ephox=scope.ephox=scope.ephox||{};var bolt=ephox.bolt=ephox.bolt||{};var def=function(deps,factory){return factory.apply(null,deps)};var module=bolt.module=bolt.module||{};module.bootstrap=module.bootstrap||{};module.config=module.config||{};module.error=module.error||{};module.modulator=module.modulator||{};module.reader=module.reader||{};module.runtime=module.runtime||{};module.util=module.util||{};module.error.error=def([],function(){var die=function(msg){throw msg||new Error("unknown error")};return{die:die}});module.config.mapper=def([],function(){var flat=function(id){return id};var hierarchical=function(id){return id.replace(/\./g,"/")};var constant=function(name){return function(){return name}};return{flat:flat,hierarchical:hierarchical,constant:constant}});module.api=def([module.runtime],function(runtime){var delegate=function(method){return function(){return runtime[method].apply(null,arguments)}};return{define:delegate("define"),require:delegate("require"),demand:delegate("demand"),main:delegate("main"),load:delegate("load"),loadscript:delegate("loadscript")}});module.util.path=def([],function(){var dirname=function(file){var normalized=file.replace(/\\/g,"/");var end=normalized.lastIndexOf("/");return normalized.substring(0,end)};var basename=function(file){var normalized=file.replace(/\\/g,"/");var end=normalized.lastIndexOf("/");return normalized.substring(end+1)};return{basename:basename,dirname:dirname}});module.util.locator=def([],function(){var browser=function(){var scripts=document.getElementsByTagName("script");return scripts[scripts.length-1].src};var runtime=module.runtime.locate;var locate=function(){var f=runtime||browser;return f()};return{locate:locate}});module.util.pather=def([module.util.path],function(path){var create=function(relativeto){var base=path.dirname(relativeto);return function(path){return base+"/"+path}};return{create:create}});module.modulator.modulators=def([ephox.bolt.kernel.fp.functions,ephox.bolt.kernel.modulator.bolt,ephox.bolt.loader.api.commonjsevaller,ephox.bolt.loader.api.scripttag,ephox.bolt.loader.api.xhrevaller,ephox.bolt.loader.api.xhrinjector],function(fn,bolt,commonjsevaller,scripttag,xhrevaller,xhrinjector){var wrap=function(modulator,loader){var create=fn.curry(modulator.create,loader);return{create:create}};return{boltcommonjs:wrap(bolt,commonjsevaller),boltscripttag:wrap(bolt,scripttag),boltxhreval:wrap(bolt,xhrevaller),boltxhrinjector:wrap(bolt,xhrinjector)}});module.config.builtins=def([ephox.bolt.module.modulator.modulators.boltscripttag,ephox.bolt.module.modulator.modulators.boltcommonjs],function(boltscripttag,boltcommonjs){return{browser:{bolt:boltscripttag,amd:boltscripttag},commonjs:{bolt:boltcommonjs,amd:boltcommonjs}}});module.config.specs=def([module.util.pather],function(pather){var type=function(type,implementation){return{type:type,implementation:implementation,modulator:implementation+".Modulator",compiler:implementation+".Compiler"}};var source=function(relativeto){return function(type){return{type:type,relativeto:relativeto,args:[pather.create(relativeto)].concat(Array.prototype.slice.call(arguments,1))}}};return{type:type,source:source}});module.reader.bouncing=def([ephox.bolt.kernel.fp.array,module.error.error,module.config.specs],function(ar,error,specs){var bounce=function(done,read,acc){var next=acc.configs.shift();read(next.relativeto,next.config,done,acc)};var tick=function(file,cfg,done,read,acc){var munged=ar.map(cfg.configs||[],function(config){return{relativeto:file,config:config}});var accumulated={sources:acc.sources.concat(cfg.sources||[]),types:acc.types.concat(cfg.types||[]),configs:munged.concat(acc.configs)};if(accumulated.configs.length>0){bounce(done,read,accumulated)}else{done({sources:accumulated.sources,types:accumulated.types})}};var evaluate=function(file,payload,done,read,acc){var result={};var mapper=module.config.mapper;var type=specs.type;var source=specs.source(file);var configure=function(configuration){result=configuration};try{eval(payload)}catch(e){throw"Could not load configuration ["+file+"], with: "+e}tick(file,result,done,read,acc)};return{evaluate:evaluate}});module.reader.browser=def([module.error.error,module.reader.bouncing,module.util.path,ephox.bolt.loader.transporter.xhr],function(error,bouncing,path,xhr){var read=function(relativeto,file,done,acc){var accumulated=acc||{sources:[],types:[],configs:[]};var base=path.dirname(relativeto);var absolute=base+"/"+file;xhr.request(absolute,function(payload){bouncing.evaluate(absolute,payload,done,read,accumulated)},error.die)};return{read:read}});module.reader.node=def([module.reader.bouncing],function(bouncing,path,fs){var read=function(relativeto,file,done,acc){var fs=require("fs");var path=require("path");var accumulated=acc||{sources:[],types:[],configs:[]};var base=path.dirname(relativeto);var absolute=path.resolve(base,file);var payload=fs.readFileSync(absolute,"UTF-8");bouncing.evaluate(absolute,payload,done,read,accumulated)};return{read:read}});module.reader.direct=def([],function(){var create=function(configuration){return function(done){done({sources:configuration.sources||[],types:configuration.types||[],configs:configuration.configs||[]})}};return{create:create}});module.bootstrap.configloader=def([module.util.locator,module.reader.browser],function(locator,browser){var create=function(file){var script=locator.locate();return function(done){browser.read(script,file,done)}};return{create:create}});module.bootstrap.deferred=def([ephox.bolt.kernel.fp.array],function(ar){var deferred=[];var require=function(ids,fn){var r=function(real){real(ids,fn)};deferred.push(r)};var configured=function(require){ar.each(deferred,function(action){action(require)});deferred=[]};return{require:require,configured:configured}});module.bootstrap.main=def([ephox.bolt.kernel.api.config,module.bootstrap.deferred,module.runtime],function(config,deferred,runtime){var main=function(id,args,configids,callback){runtime.require(configids||[],function(){callback&&callback.apply(null,arguments);runtime.require([id],function(module){module.apply(null,args||[])})})};return{main:main}});module.bootstrap.install=def([ephox.bolt.kernel.api.config,module.bootstrap.deferred,module.bootstrap.main,module.runtime,module.error.error],function(config,deferred,main,runtime,error){var notready=function(){throw"bolt not initialised, can not call define or demand, did you mean to use require or main?"};var install=function(reader,builtins,load,loadscript){runtime.define=notready;runtime.demand=notready;runtime.require=deferred.require;runtime.main=main.main;runtime.load=load;runtime.loadscript=loadscript;reader(function(configuration){var bolt=config.configure(configuration,builtins,error.die);runtime.define=bolt.define;runtime.require=bolt.require;runtime.demand=bolt.demand;deferred.configured(runtime.require)})};return{install:install}})})(Function("return this")());(function(){var d=ephox.bolt.module.bootstrap.install;var a=ephox.bolt.module.config.builtins.browser;var e=ephox.bolt.loader.transporter.xhr.request;var i=ephox.bolt.loader.api.scripttag.load;var f=ephox.bolt.module.reader.direct;var b=ephox.bolt.module.config.mapper;var g=ephox.bolt.module.util.locator;var c=ephox.bolt.module.config.specs.source(g.locate());var h=f.create({sources:[c("bolt","tinymce/inlite/Theme",".",b.constant("theme")),c("bolt","global!tinymce.ThemeManager",".",b.constant("theme")),c("bolt","global!tinymce.util.Delay",".",b.constant("theme")),c("bolt","tinymce/inlite/ui/Panel",".",b.constant("theme")),c("bolt","tinymce/inlite/ui/Buttons",".",b.constant("theme")),c("bolt","tinymce/inlite/core/SkinLoader",".",b.constant("theme")),c("bolt","tinymce/inlite/core/SelectionMatcher",".",b.constant("theme")),c("bolt","tinymce/inlite/core/ElementMatcher",".",b.constant("theme")),c("bolt","tinymce/inlite/core/Matcher",".",b.constant("theme")),c("bolt","tinymce/inlite/alien/Arr",".",b.constant("theme")),c("bolt","tinymce/inlite/core/PredicateId",".",b.constant("theme")),c("bolt","global!tinymce.util.Tools",".",b.constant("theme")),c("bolt","global!tinymce.ui.Factory",".",b.constant("theme")),c("bolt","global!tinymce.DOM",".",b.constant("theme")),c("bolt","tinymce/inlite/ui/Toolbar",".",b.constant("theme")),c("bolt","tinymce/inlite/ui/Forms",".",b.constant("theme")),c("bolt","tinymce/inlite/core/Measure",".",b.constant("theme")),c("bolt","tinymce/inlite/core/Layout",".",b.constant("theme")),c("bolt","tinymce/inlite/file/Conversions",".",b.constant("theme")),c("bolt","tinymce/inlite/file/Picker",".",b.constant("theme")),c("bolt","tinymce/inlite/core/Actions",".",b.constant("theme")),c("bolt","global!tinymce.EditorManager",".",b.constant("theme")),c("bolt","global!tinymce.util.Promise",".",b.constant("theme")),c("bolt","tinymce/inlite/alien/Uuid",".",b.constant("theme")),c("bolt","tinymce/inlite/alien/Unlink",".",b.constant("theme")),c("bolt","tinymce/inlite/core/UrlType",".",b.constant("theme")),c("bolt","global!tinymce.geom.Rect",".",b.constant("theme")),c("bolt","tinymce/inlite/core/Convert",".",b.constant("theme")),c("bolt","tinymce/inlite/alien/Bookmark",".",b.constant("theme")),c("bolt","global!tinymce.dom.TreeWalker",".",b.constant("theme")),c("bolt","global!tinymce.dom.RangeUtils",".",b.constant("theme"))]});d.install(h,a,e,i)})();