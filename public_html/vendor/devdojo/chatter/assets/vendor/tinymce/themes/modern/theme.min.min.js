tinymce.ThemeManager.add("modern",function(N){function M(a,h){var g,f=[];if(a){return z(a.split(/[ ,]/),function(c){function e(){function i(j){return function(n,m){for(var l,k=m.parents.length;k--&&(l=m.parents[k].nodeName,"OL"!=l&&"UL"!=l);){}c.active(n&&l==j)}}var b=N.selection;"bullist"==d&&b.selectorChanged("ul > li",i("UL")),"numlist"==d&&b.selectorChanged("ol > li",i("OL")),c.settings.stateSelector&&b.selectorChanged(c.settings.stateSelector,function(j){c.active(j)},!0),c.settings.disabledStateSelector&&b.selectorChanged(c.settings.disabledStateSelector,function(j){c.disabled(j)})}var d;"|"==c?g=null:A.has(c)?(c={type:c,size:h},f.push(c),g=null):(g||(g={type:"buttongroup",items:[]},f.push(g)),N.buttons[c]&&(d=c,c=N.buttons[d],"function"==typeof c&&(c=c()),c.type=c.type||"button",c.size=h,c=A.create(c),g.items.push(c),N.initialized?e():N.on("init",e)))}),{type:"toolbar",layout:"flow",items:f}}}function L(b){function h(a){return a?(g.push(M(a,b)),!0):void 0}var g=[];if(tinymce.isArray(B.toolbar)){if(0===B.toolbar.length){return}tinymce.each(B.toolbar,function(d,c){B["toolbar"+(c+1)]=d}),delete B.toolbar}for(var f=1;10>f&&h(B["toolbar"+f]);f++){}return g.length||B.toolbar===!1||h(B.toolbar||u),g.length?{type:"panel",layout:"stack",classes:"toolbar-grp",ariaRoot:!0,ariaRemember:!0,items:g}:void 0}function K(){function a(d){var e;return"|"==d?{text:"|"}:e=N.menuItems[d]}function p(P){var O,t,s,r,q;if(q=tinymce.makeMap((B.removed_menuitems||"").split(/[ ,]/)),B.menu?(t=B.menu[P],r=!0):t=v[P],t){O={text:t.title},s=[],z((t.items||"").split(/[ ,]/),function(d){var e=a(d);e&&!q[d]&&s.push(a(d))}),r||z(N.menuItems,function(c){c.context==P&&("before"==c.separator&&s.push({text:"|"}),c.prependToContext?s.unshift(c):s.push(c),"after"==c.separator&&s.push({text:"|"}))});for(var b=0;b<s.length;b++){"|"==s[b].text&&(0!==b&&b!=s.length-1||s.splice(b,1))}if(O.menu=s,!O.menu.length){return null}}return O}var o,n=[],m=[];if(B.menu){for(o in B.menu){m.push(o)}}else{for(o in v){m.push(o)}}for(var l="string"==typeof B.menubar?B.menubar.split(/[ ,]/):m,k=0;k<l.length;k++){var j=l[k];j=p(j),j&&n.push(j)}return n}function J(a){function d(b){var e=a.find(b)[0];e&&e.focus(!0)}N.shortcuts.add("Alt+F9","",function(){d("menubar")}),N.shortcuts.add("Alt+F10","",function(){d("toolbar")}),N.shortcuts.add("Alt+F11","",function(){d("elementpath")}),a.on("cancel",function(){N.focus()})}function I(a,n){function m(b){return{width:b.clientWidth,height:b.clientHeight}}var l,k,j,i;l=N.getContainer(),k=N.getContentAreaContainer().firstChild,j=m(l),i=m(k),null!==a&&(a=Math.max(B.min_width||100,a),a=Math.min(B.max_width||65535,a),y.setStyle(l,"width",a+(j.width-i.width)),y.setStyle(k,"width",a)),n=Math.max(B.min_height||100,n),n=Math.min(B.max_height||65535,n),y.setStyle(k,"height",n),N.fire("ResizeEditor")}function H(a,f){var e=N.getContentAreaContainer();C.resizeTo(e.clientWidth+a,e.clientHeight+f)}function G(){function T(){return N.contextToolbars||[]}function S(f){var i,h,g;return i=tinymce.DOM.getPos(N.getContentAreaContainer()),h=N.dom.getRect(f),g=N.dom.getRoot(),"BODY"==g.nodeName&&(h.x-=g.ownerDocument.documentElement.scrollLeft||g.scrollLeft,h.y-=g.ownerDocument.documentElement.scrollTop||g.scrollTop),h.x+=i.x,h.y+=i.y,h}function R(){z(N.contextToolbars,function(c){c.panel&&c.panel.hide()})}function Q(e,d,f){d=d?d.substr(0,2):"",z({t:"down",b:"up"},function(g,c){e.classes.toggle("arrow-"+g,f(c,d.substr(0,1)))}),z({l:"left",r:"right"},function(g,c){e.classes.toggle("arrow-"+g,f(c,d.substr(1,1)))})}function P(c){return{left:c.x,top:c.y,width:c.w,height:c.h,right:c.x+c.w,bottom:c.y+c.h}}function O(g,f,j,i,h){return h=P({x:g,y:f,w:h.w,h:h.h}),B.inline_toolbar_position_handler&&(h=B.inline_toolbar_position_handler({elementRect:P(j),contentAreaRect:P(i),panelRect:h})),h}function q(d,c){d.moveTo(c.left,c.top)}function o(t){var s,r,p,i,h,f,e,d;if(!N.removed){if(!t||!t.toolbar.panel){return void R()}e=["bc-tc","tc-bc","tl-bl","bl-tl","tr-br","br-tr"],h=t.toolbar.panel,h.show(),p=S(t.element),r=tinymce.DOM.getRect(h.getEl()),i=tinymce.DOM.getRect(N.getContentAreaContainer()||N.getBody()),d=25,p.w=t.element.clientWidth,p.h=t.element.clientHeight,N.inline||(i.w=N.getDoc().documentElement.offsetWidth),N.selection.controlSelection.isResizable(t.element)&&p.w<d&&(p=x.inflate(p,0,8)),s=x.findBestRelativePosition(r,p,i,e),p=x.clamp(p,i),s?(f=x.relativePosition(r,p,s),q(h,O(f.x,f.y,p,i,r))):(i.h+=r.h,p=x.intersect(i,p),p?(s=x.findBestRelativePosition(r,p,i,["bc-tc","bl-tl","br-tr"]),s?(f=x.relativePosition(r,p,s),q(h,O(f.x,f.y,p,i,r))):q(h,O(p.x,p.y,p,i,r))):h.hide()),Q(h,s,function(g,c){return g===c})}}function n(){function c(){N.selection&&o(V(N.selection.getNode()))}tinymce.util.Delay.requestAnimationFrame(c)}function m(){U||(U=N.selection.getScrollContainer()||N.getWin(),tinymce.$(U).on("scroll",n),N.on("remove",function(){tinymce.$(U).off("scroll")}))}function b(f){var e;return f.toolbar.panel?(f.toolbar.panel.show(),void o(f)):(m(),e=A.create({type:"floatpanel",role:"dialog",classes:"tinymce tinymce-inline arrow",ariaLabel:"Inline toolbar",layout:"flex",direction:"column",align:"stretch",autohide:!1,autofix:!0,fixed:!0,border:1,items:M(f.toolbar.items),oncancel:function(){N.focus()}}),f.toolbar.panel=e,e.renderTo(document.body).reflow(),void o(f))}function a(){tinymce.each(T(),function(c){c.panel&&c.panel.hide()})}function V(c){var k,j,i,h=T();for(i=N.$(c).parents().add(c),k=i.length-1;k>=0;k--){for(j=h.length-1;j>=0;j--){if(h[j].predicate(i[k])){return{toolbar:h[j],element:i[k]}}}}return null}var U;N.on("click keyup setContent",function(c){("setcontent"!=c.type||c.selection)&&tinymce.util.Delay.setEditorTimeout(N,function(){var d;d=V(N.selection.getNode()),d?(a(),b(d)):a()})}),N.on("blur hide",a),N.on("ObjectResizeStart",function(){var c=V(N.selection.getNode());c&&c.toolbar.panel&&c.toolbar.panel.hide()}),N.on("nodeChange ResizeEditor ResizeWindow",n),N.on("remove",function(){tinymce.each(T(),function(c){c.panel&&c.panel.remove()}),N.contextToolbars={}}),N.shortcuts.add("ctrl+shift+e > ctrl+shift+p","",function(){var c=V(N.selection.getNode());c&&c.toolbar.panel&&c.toolbar.panel.items()[0].focus()})}function F(b){return function(){b.initialized?b.fire("SkinLoaded"):b.on("init",function(){b.fire("SkinLoaded")})}}function E(a){function i(){if(l&&l.moveRel&&l.visible()&&!l._fixed){var j=N.selection.getScrollContainer(),p=N.getBody(),o=0,n=0;if(j){var m=y.getPos(p),k=y.getPos(j);o=Math.max(0,k.x-m.x),n=Math.max(0,k.y-m.y)}l.fixed(!1).moveRel(p,N.rtl?["tr-br","br-tr"]:["tl-bl","bl-tl","tr-br"]).moveBy(o,n)}}function e(){l&&(l.show(),i(),y.addClass(N.getBody(),"mce-edit-focus"))}function d(){l&&(l.hide(),w.hideAll(),y.removeClass(N.getBody(),"mce-edit-focus"))}function c(){return l?void (l.visible()||e()):(l=C.panel=A.create({type:h?"panel":"floatpanel",role:"application",classes:"tinymce tinymce-inline",layout:"flex",direction:"column",align:"stretch",autohide:!1,autofix:!0,fixed:!!h,border:1,items:[B.menubar===!1?null:{type:"menubar",border:"0 0 1 0",items:K()},L(B.toolbar_items_size)]}),N.fire("BeforeRenderUI"),l.renderTo(h||document.body).reflow(),J(l),e(),G(),N.on("nodeChange",i),N.on("activate",e),N.on("deactivate",d),void N.nodeChanged())}var l,h;return B.fixed_toolbar_container&&(h=y.select(B.fixed_toolbar_container)[0]),B.content_editable=!0,N.on("focus",function(){a.skinUiCss?tinymce.DOM.styleSheetLoader.load(a.skinUiCss,c,c):c()}),N.on("blur hide",d),N.on("remove",function(){l&&(l.remove(),l=null)}),a.skinUiCss&&tinymce.DOM.styleSheetLoader.load(a.skinUiCss,F(N)),{}}function D(a){function e(){return function(b){"readonly"==b.mode?d.find("*").disabled(!0):d.find("*").disabled(!1)}}var d,c,f;return a.skinUiCss&&tinymce.DOM.styleSheetLoader.load(a.skinUiCss,F(N)),d=C.panel=A.create({type:"panel",role:"application",classes:"tinymce",style:"visibility: hidden",layout:"stack",border:1,items:[B.menubar===!1?null:{type:"menubar",border:"0 0 1 0",items:K()},L(B.toolbar_items_size),{type:"panel",name:"iframe",layout:"stack",classes:"edit-area",html:"",border:"1 0 0 0"}]}),B.resize!==!1&&(c={type:"resizehandle",direction:B.resize,onResizeStart:function(){var g=N.getContentAreaContainer().firstChild;f={width:g.clientWidth,height:g.clientHeight}},onResize:function(b){"both"==B.resize?I(f.width+b.deltaX,f.height+b.deltaY):I(null,f.height+b.deltaY)}}),B.statusbar!==!1&&d.add({type:"panel",name:"statusbar",classes:"statusbar",layout:"flow",border:"1 0 0 0",ariaRoot:!0,items:[{type:"elementpath",editor:N},c]}),N.fire("BeforeRenderUI"),N.on("SwitchMode",e()),d.renderBefore(a.targetNode).reflow(),B.readonly&&N.setMode("readonly"),B.width&&tinymce.DOM.setStyle(d.getEl(),"width",B.width),N.on("remove",function(){d.remove(),d=null}),J(d),G(),{iframeContainer:d.find("#iframe")[0].getEl(),editorContainer:d.getEl()}}var C=this,B=N.settings,A=tinymce.ui.Factory,z=tinymce.each,y=tinymce.DOM,x=tinymce.geom.Rect,w=tinymce.ui.FloatPanel,v={file:{title:"File",items:"newdocument"},edit:{title:"Edit",items:"undo redo | cut copy paste pastetext | selectall"},insert:{title:"Insert",items:"|"},view:{title:"View",items:"visualaid |"},format:{title:"Format",items:"bold italic underline strikethrough superscript subscript | formats | removeformat"},table:{title:"Table"},tools:{title:"Tools"}},u="undo redo | styleselect | bold italic | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | link image";C.renderUI=function(a){var f=B.skin!==!1?B.skin||"lightgray":!1;if(f){var e=B.skin_url;e=e?N.documentBaseURI.toAbsolute(e):tinymce.baseURL+"/skins/"+f,tinymce.Env.documentMode<=7?a.skinUiCss=e+"/skin.ie7.min.css":a.skinUiCss=e+"/skin.min.css",N.contentCSS.push(e+"/content"+(N.inline?".inline":"")+".min.css")}return N.on("ProgressState",function(b){C.throbber=C.throbber||new tinymce.ui.Throbber(C.panel.getEl("body")),b.state?C.throbber.show(b.time):C.throbber.hide()}),B.inline?E(a):D(a)},C.resizeTo=I,C.resizeBy=H});