!function(u){var t=jQuery.fn;jQuery.extend(!0,t,{rsWhiteBoard:function(b){return this.each(function(){var c=this.opt;jQuery(this).on("revolution.slide.onloaded",function(){s(c)})})}});var s=function(g){if(o=g.whiteboard,void 0===o){return !1}var e="position:absolute;z-index:1000;top:0px;left:0px;",j="position:absolute;z-index:1000;top:0px;left:0px;",i="position:absolute;z-index:1000;top:0px;left:0px;",h="position:absolute; top:0px;left:0px;background-size:contain;background-repeat:no-repeat;background-position:center center;";void 0!=o.movehand&&(o.movehand.markup='<div class="wb-move-hand wb-thehand" style="'+e+'"><div class="wb-hand-inner" style="'+j+";width:"+o.movehand.width+"px;height:"+o.movehand.height+'px"><div class="wb-hand-scale" ><div class="wb-hand-image" style="'+h+"width:"+o.movehand.width+"px;height:"+o.movehand.height+"px;background-image:url("+o.movehand.src+');"></div></div></div>'),void 0!=o.writehand&&(o.writehand.markup='<div class="wb-draw-hand wb-thehand" style="'+e+'"><div class="wb-hand-inner" style="'+j+'"><div class="wb-hand-scale" style="'+i+'"><div class="wb-hand-image" style="'+h+"width:"+o.writehand.width+"px;height:"+o.writehand.height+"px;background-image:url("+o.writehand.src+');"></div></div></div>'),jQuery(window).resize(function(){clearTimeout(g.whiteboard_resize_timer),g.whiteboard_resize_timer=setTimeout(function(){jQuery(".wb-thehand").each(function(){var a=jQuery(this).find(".wb-hand-scale");punchgs.TweenLite.set(a,{scale:g.bw})})},50)}),g.c.on("revolution.slide.onbeforeswap",function(a,d){g.c.find(".wb-thehand").remove()}),g.c.on("revolution.layeraction",function(a,z){var y=z.layersettings.whiteboard;if(void 0!=y){1!=y.configured&&("write"!=y.hand_function&&"draw"!=y.hand_function||(y.jitter_distance=void 0!=y.jitter_distance?parseInt(y.jitter_distance,0)/100:parseInt(o.writehand.jittering.distance,0)/100,y.jitter_distance_horizontal=void 0!=y.jitter_distance_horizontal?parseInt(y.jitter_distance_horizontal,0)/100:parseInt(o.writehand.jittering.distance_horizontal,0)/100,y.jitter_offset=void 0!=y.jitter_offset?parseInt(y.jitter_offset,0)/100:parseInt(o.writehand.jittering.offset,0)/100,y.jitter_offset_horizontal=void 0!=y.jitter_offset_horizontal?parseInt(y.jitter_offset_horizontal,0)/100:parseInt(o.writehand.jittering.offset_horizontal,0)/100,y.hand_type=y.hand_type||o.writehand.handtype),"move"==y.hand_function&&(y.hand_type=y.hand_type||o.movehand.handtype),y.configured=!0);var x=z.layer.data(),w=jQuery(x._pw).find(".wb-thehand");if(w.length>0){var v=w.data("wb")}else{var v=jQuery.extend(!0,{},z.layersettings.whiteboard)}if("enterstage"==z.eventtype){if(jQuery(z.layer).is(":visible")===!1){return}z.layer.hasClass("handadded")||(z.layer.addClass("handadded"),z.layersettings.handEffect="on",1!=v.handadded&&m(g,z,v),l(z,v))}"enteredstage"==z.eventtype&&z.layer.hasClass("handadded")&&!z.layer.hasClass("handremoved")&&(z.layer.addClass("handremoved"),z.layersettings.handEffect="off",0==q(g,z,v)&&k(g,z,v)),"leavestage"==z.eventtype&&(z.layer.removeClass("handadded"),z.layer.removeClass("handremoved"))}})},r=function(e){var d={},f=e.layer.data();return d.obj="",d.startat=9999999,jQuery(f._li).find(".tp-caption").each(function(){var b=jQuery(this),g=b.data();1!=g.active&&void 0!=g.whiteboard&&"move"!=g.whiteboard.hand_function&&parseInt(g.frames[0].delay,0)<d.startat&&(d.obj=b,d.startat=parseInt(g.frames[0].delay,0))}),d},q=function(G,F,E){var D=!1,C=F.layer.data(),B=jQuery(C._pw).find(".wb-thehand");if("on"===C.whiteboard.goto_next_layer&&"move"!=C.whiteboard.hand_function&&0==G.c.find(".wb-between-stations").length){var A=r(F);if(void 0!=A&&A.obj.length>0){var z=B.find(".wb-hand-inner"),y=void 0!=C.timeline&&void 0!=C.timeline._labels&&void 0!=C.timeline._labels.frame_0_end?C.timeline._labels.frame_0_end:0,x=A.startat/1000-y,w=jQuery(C._pw).position(),v=A.obj.data("_pw").position(),d=B.closest(".tp-static-layers").length>0;B.appendTo(G.ul),B.addClass("wb-between-stations"),d?B.css({zIndex:200}):B.css({zIndex:100}),E.handEffect="off",punchgs.TweenLite.fromTo(B,x,{top:w.top,left:w.left},{top:v.top,left:v.left}),punchgs.TweenLite.to(z,x,{x:0,y:0,onComplete:function(){B.remove()}}),D=!0}}return D},p=function(f,e,j){if("off"!=j.handEffect&&1==j.handadded){var i=e.layer.data(),h=(j.maxwave||i.eoh,parseInt(j.hand_angle,0)||10);ro="write"==j.hand_function||"draw"==j.hand_function?Math.random()*h-h/2:0,j.rotatespeed=j.rotatespeed||0.05,j.rotating_anim=punchgs.TweenLite.to(f,j.rotatespeed,{rotationZ:ro,ease:punchgs.Power3.easeOut,onComplete:function(){p(f,e,j)}})}},n=function(i,g,y){if("off"!=y.handEffect&&1==y.handadded){var x=g.layer.data();if("horizontal"==y.jitter_direction){var w=y.maxwave||x.eow*y.jitter_distance_horizontal,v=x.eow*y.jitter_offset_horizontal;if(0==w){return}y.current_x_offset=y.current_x_offset||0,y.lastwave=Math.random()*w+v,y.jitterspeed=y.jitterspeed||0.05,y.jittering_anim=punchgs.TweenLite.to(i,y.jitterspeed,{x:y.lastwave,ease:punchgs.Power3.easeOut,onComplete:function(){n(i,g,y)}})}else{var j=y.maxwave||x.eoh;if(0==j){return}y.current_y_offset=y.current_y_offset||0,y.lastwave=y.lastwave==y.current_y_offset+j*y.jitter_offset?Math.random()*(j*y.jitter_distance)+y.current_y_offset+j*y.jitter_offset:y.current_y_offset+j*y.jitter_offset,y.jitterspeed=y.jitterspeed||0.05,y.jittering_anim=punchgs.TweenLite.to(i,y.jitterspeed,{y:y.lastwave,ease:punchgs.Power3.easeOut,onComplete:function(){n(i,g,y)}})}}},m=function(j,h,A){var z="move"==A.hand_function?j.whiteboard.movehand:j.whiteboard.writehand,y=z.markup,x=h.layer.data();A.hand_full_rotation=A.hand_full_rotation||0,A.hand_origin=z.transform.transformX+"px "+z.transform.transformY+"px",A.hand_scale="right"==A.hand_type?1:-1,A.hand_x_offset=parseInt(A.hand_x_offset,0)||0,A.hand_y_offset=parseInt(A.hand_y_offset,0)||0,jQuery(y).appendTo(jQuery(x._pw)),A.handadded=!0;var w=jQuery(x._pw).find(".wb-thehand"),v=(w.find(".wb-hand-inner"),w.find(".wb-hand-image"));punchgs.TweenLite.set(v,{scaleX:A.hand_scale,rotation:A.hand_full_rotation,transformOrigin:A.hand_origin,x:0-z.transform.transformX+A.hand_x_offset,y:0-z.transform.transformY+A.hand_y_offset}),punchgs.TweenLite.set(w.find(".wb-hand-scale"),{scale:j.bw,transformOrigin:"0% 0%"})},l=function(G,F){var E=G.layer.data(),D=jQuery(E._pw).find(".wb-thehand"),C=D.find(".wb-hand-inner"),B=(D.find(".wb-hand-image"),punchgs.TweenLite.getTweensOf(G.layer));switch(F.hand_function){case"write":case"draw":var A=E.frames[G.frame_index].speed/1000;if(void 0!=E.splittext&&"none"!=E.splittext){F.tweens=G.layersettings.timeline.getChildren(!0,!0,!1),jQuery.each(F.tweens,function(b,a){a.eventCallback("onStart",function(R,Q,P){var O=jQuery(this.target),N=O.width(),M=O.height();if(void 0!==O&&void 0!==O.html()&&O.html().length>0&&9!=O.html().charCodeAt(0)&&10!=O.html().charCodeAt(0)){var L=O.position(),K=O.parent(),J=K.parent(),I=("write"==P.hand_function?10*Math.random()-5:0,this._duration),H=L.left,c=L.top;K.hasClass("tp-splitted")&&(H=K.position().left+H,c=K.position().top+c),J.hasClass("tp-splitted")&&(H=J.position().left+H,c=J.position().top+c),P.rotatespeed=void 0!==P.hand_angle_repeat?parseFloat(I)/parseFloat(P.hand_angle_repeat):I>1?I/6:I>0.5?I/6:I/3,P.jitterspeed=void 0!==P.jitter_repeat?parseFloat(I)/parseFloat(P.jitter_repeat):I>1?I/6:I>0.5?I/6:I/3,P.current_y_offset!=c&&(I=0.1),P.current_y_offset=c||0,P.maxwave=M,b<P.tweens.length-1?punchgs.TweenLite.to(R,I,{x:H+N}):punchgs.TweenLite.to(R,I,{x:H+N,onComplete:function(){P.handEffect="off";try{P.jittering_anim.kill(!1)}catch(d){}}})}else{P.current_y_offset=0,P.maxwave=M,P.handEffect="off";try{P.jittering_anim.kill(!1)}catch(R){}}},[C,G,F])})}else{var z=E.eow*F.jitter_distance_horizontal,y=E.eow*F.jitter_offset_horizontal,x=E.eoh*F.jitter_distance,w=E.eoh*F.jitter_offset;if(F.rotatespeed=void 0!==F.hand_angle_repeat?parseFloat(A)/parseFloat(F.hand_angle_repeat):A>1?A/6:A>0.5?A/6:A/3,F.jitterspeed=void 0!==F.jitter_repeat?parseFloat(A)/parseFloat(F.jitter_repeat):A>1?A/6:A>0.5?A/6:A/3,"right_to_left"==F.hand_direction){var v=E.eow-y,h=v-z;punchgs.TweenLite.fromTo(C,A,{x:v},{x:h,ease:G.layersettings.frames[0].ease,onComplete:function(){F.handEffect="off"}})}else{if("top_to_bottom"==F.hand_direction){var g=w,f=g+x;punchgs.TweenLite.fromTo(C,A,{y:g},{y:f,ease:G.layersettings.frames[0].ease,onComplete:function(){F.handEffect="off"}}),F.jitter_direction="horizontal"}else{if("bottom_to_top"==F.hand_direction){var g=E.eoh-w,f=g-x;punchgs.TweenLite.fromTo(C,A,{y:g},{y:f,ease:G.layersettings.frames[0].ease,onComplete:function(){F.handEffect="off"}}),F.jitter_direction="horizontal"}else{var v=y,h=v+z;punchgs.TweenLite.fromTo(C,A,{x:v},{x:h,ease:G.layersettings.frames[0].ease,onComplete:function(){F.handEffect="off"}})}}}}n(C,G,F),p(C,G,F);break;case"move":D.data("outspeed",G.layersettings.frames[G.layersettings.frames.length-1].speed/1000),D.data("outease",G.layersettings.frames[G.layersettings.frames.length-1].ease),B[0].eventCallback("onUpdate",function(b){var d=(this.target.style,this.target._gsTransform),c={};c.x=d.x,c.y=d.y,void 0===D.data("pos")&&D.data("pos",c),F.hand_inner_animation=punchgs.TweenLite.set(D,{x:c.x,y:c.y})},[G])}D.data("wb",F)},k=function(F,E,D){var C=E.layer.data(),B=jQuery(C._pw).find(".wb-thehand"),A=B.data("pos")||{x:0,y:0},z=B.position()||{top:0,left:0},y=C.frames[E.layersettings.frames.length-1].speed/1000||2,x=C.frames[E.layersettings.frames.length-1].ease,w=0==A.x&&0==A.y?0:1;if(y=0.5*y,"move"!=D.hand_function){var v=jQuery(C._pw).position();F.c.offset();z.left="right"==D.hand_type?F.c.width()-v.left+C.eow:0-v.left-C.eow,z.top=F.c.height()}punchgs.TweenLite.to(B,y,{top:z.top,left:z.left,autoAlpha:w,x:A.x,y:A.y,ease:x,onComplete:function(){B.remove(),D.handadded=!1}})}}(jQuery);