var RsSnowAddOn=function(g,f){if(!f){return}if(!f.children(".tp-static-layers").length){var d=document.createElement("div");d.className="tp-static-layers";d.style="pointer-events: none";f[0].appendChild(d)}var b=f[0].opt.snow,e=b.startSlide,c=b.endSlide,h,a;b={selector:".tp-static-layers",dimension:"self",particleMaxPer:parseInt(b.maxNum,10),particlaSize:[parseFloat(b.minSize),parseFloat(b.maxSize)],particleOpacity:[parseFloat(b.minOpacity),parseFloat(b.maxOpacity)],particleSpeed:[parseInt(b.minSpeed,10),parseInt(b.maxSpeed,10)],particleSinus:[parseInt(b.minSinus,10),parseInt(b.maxSinus,10)]};f.on("revolution.slide.onchange",function(j,k){var i=k.slideIndex;if(e==="first"){e=1}if(c==="last"){c=f.revmaxslide()}if(i>=e&&i<=c){if(!a){f.letItSnow(b);a=true}else{if(!h){f.letItSnow("winter")}}h=true}else{if(a){f.letItSnow("summer");h=false}}})};(function(h,f){function b(a){a.pause=!0,a.sc.find(".snowflakes_wrapper").remove(),a.c.removeData("snowflakes"),a={}}function j(i){i.snowflakes=[];for(var a=i.w*i.h/1500000;i.snowflakes.length<i.particleMaxPer*a;){i.snowflakes.push(c(i))}}function d(a){window.requestAnimationFrame(function(){g(a)})}function g(q){if(q==f||q.ctx==f||1==q.destroyed||1==q.pause){return !1}q.ctx.clearRect(0,0,2700,2500);var m=q.h/3,u=q.h/3*2;for(var p in q.snowflakes){if(q.snowflakes[p].y+0.1*q.snowflakes[p].r<0&&1==q.summer||q.snowflakes[p].y>q.h+q.snowflakes[p].r&&1==q.summer){}else{q.snowflakes[p].delta+=q.snowflakes[p].delta==Math.PI/2?-q.snowflakes[p].delta:Math.random()/500-0.01,q.summer?q.snowflakes[p].y+=q.snowflakes[p].speed/50+0.1*q.snowflakes[p].r:q.snowflakes[p].y+=q.snowflakes[p].speed/100+0.1*q.snowflakes[p].r,q.snowflakes[p].x+=Math.sin(q.snowflakes[p].delta)*(0.1*q.snowflakes[p].r),q.snowflakes[p].y>q.h+q.snowflakes[p].r&&1!=q.summer&&(q.snowflakes[p]=c(q),q.snowflakes[p].y=0-q.snowflakes[p].r);var k=q.snowflakes[p].y-m,s=q.snowflakes[p].r,t=q.snowflakes[p].alpha;if(k>0||1==q.summer){var i=1-k/u;s=q.snowflakes[p].r*i,t=q.snowflakes[p].alpha*i}s=0.1>s?0.1:s,t=0.1>t?0.1:t,q.snowflakes[p].x=q.snowflakes[p].x>q.w+q.snowflakes[p].r?0:q.snowflakes[p].x<-s?q.w:q.snowflakes[p].x,q.ctx.beginPath(),q.ctx.arc(q.snowflakes[p].x,q.snowflakes[p].y,s,2*Math.PI,!1),q.ctx.fillStyle="rgba(255,255,255,"+t+")",q.ctx.fill()}}d(q)}function c(i){var a=new Object;return a.delta=(i.particleSinus[0]+Math.random()*(i.particleSinus[1]-i.particleSinus[0]))*Math.round(2*Math.random()-1),a.r=i.particlaSize[0]+Math.random()*(i.particlaSize[1]-i.particlaSize[0]),a.alpha=i.particleOpacity[0]+Math.random()*(i.particleOpacity[1]-i.particleOpacity[0]),a.speed=(i.particleSpeed[0]+Math.random()*(i.particleSpeed[1]-i.particleSpeed[0]))*a.r/3,a.x=Math.random()*i.w,a.y=Math.random()*-i.h,a}h.fn.extend({letItSnow:function(e){var a={particleMaxPer:400,particlaSize:[0.2,6],particleOpacity:[0.3,1],particleSpeed:[30,100],particleSinus:[1,100]};return"destroy"!=e&&"stop"!=e&&"play"!=e&&"summer"!=e&&"winter"!=e&&(e=h.extend(!0,{},a,e)),this.each(function(){if(-1!=h.inArray(e,["destroy","stop","play","winter","summer"])){switch(e){case"destroy":e=h(this).data("snowflakes"),e!=f&&b(e);break;case"stop":e=h(this).data("snowflakes"),e!=f&&(e.pause=!0);break;case"play":e=h(this).data("snowflakes"),e!=f&&(e.pause=!1,d(e));break;case"summer":e=h(this).data("snowflakes"),e!=f&&(e.summer=!0);break;case"winter":e=h(this).data("snowflakes"),e!=f&&(e.summer=!1)}return !1}return e.c=h(this),e.sc=e.selector!=f?h(this).find(e.selector):e.c,0==e.sc.length?!1:e.c.data("snowflakes")!=f?!1:(e.sc.find(".snowflakes_wrapper").remove(),e.sc.append('<div class="snowflakes_wrapper" style="position:relative;z-index:0"><div class="snowflakes_wrapper_inner" style="overflow:hidden;position:relative"><canvas width="2700" height="2500" style="position:relative;" class="snowflake_canvas"></canvas></div></div>'),e.sw=e.sc.find(".snowflakes_wrapper_inner"),e.sw.data("caller_container",e.c),e.canvas=e.sc.find(".snowflake_canvas"),e.dimension!=self?e.sizer=e.c:e.sizer=e.sc,e.w=e.sizer.width(),e.h=e.sizer.height(),e.sc.find(".snowflakes_wrapper_inner").css({width:e.w,height:e.h}),e.canvas=e.canvas[0],e.snowflakes=[],e.ctx=e.canvas.getContext("2d"),j(e),d(e),e.c.data("snowflakes",e),void h(window).resize(function(){clearTimeout(e.timer),e.timer=setTimeout(function(){e.w=e.sizer.width(),e.h=e.sizer.height(),e.sc.find(".snowflakes_wrapper_inner").css({width:e.w,height:e.h}),j(e)},50)}))})}})})(jQuery);