var RsSnowAddOn=function(n,p){if(p){if(!p.children(".tp-static-layers").length){var l=document.createElement("div");l.className="tp-static-layers";l.style="pointer-events: none";p[0].appendChild(l)}var o=p[0].opt.snow,i=o.startSlide,j=o.endSlide,h,b,o={selector:".tp-static-layers",dimension:"self",particleMaxPer:parseInt(o.maxNum,10),particlaSize:[parseFloat(o.minSize),parseFloat(o.maxSize)],particleOpacity:[parseFloat(o.minOpacity),parseFloat(o.maxOpacity)],particleSpeed:[parseInt(o.minSpeed,10),parseInt(o.maxSpeed,10)],particleSinus:[parseInt(o.minSinus,10),parseInt(o.maxSinus,10)]};p.on("revolution.slide.onchange",function(d,a){var c=a.slideIndex;"first"===i&&(i=1);"last"===j&&(j=p.revmaxslide());c>=i&&c<=j?(b?h||p.letItSnow("winter"):(p.letItSnow(o),b=!0),h=!0):b&&(p.letItSnow("summer"),h=!1)})}};(function(i,l){function h(c){c.pause=!0;c.sc.find(".snowflakes_wrapper").remove();c.c.removeData("snowflakes")}function j(d){d.snowflakes=[];for(var e=d.w*d.h/1500000;d.snowflakes.length<d.particleMaxPer*e;){d.snowflakes.push(b(d))}}function a(c){window.requestAnimationFrame(function(){if(c!=l&&c.ctx!=l&&1!=c.destroyed&&1!=c.pause){c.ctx.clearRect(0,0,2700,2500);var p=c.h/3,o=c.h/3*2,g;for(g in c.snowflakes){if(!(0>c.snowflakes[g].y+0.1*c.snowflakes[g].r&&1==c.summer||c.snowflakes[g].y>c.h+c.snowflakes[g].r&&1==c.summer)){c.snowflakes[g].delta+=c.snowflakes[g].delta==Math.PI/2?-c.snowflakes[g].delta:Math.random()/500-0.01;c.summer?c.snowflakes[g].y+=c.snowflakes[g].speed/50+0.1*c.snowflakes[g].r:c.snowflakes[g].y+=c.snowflakes[g].speed/100+0.1*c.snowflakes[g].r;c.snowflakes[g].x+=0.1*Math.sin(c.snowflakes[g].delta)*c.snowflakes[g].r;c.snowflakes[g].y>c.h+c.snowflakes[g].r&&1!=c.summer&&(c.snowflakes[g]=b(c),c.snowflakes[g].y=0-c.snowflakes[g].r);var m=c.snowflakes[g].y-p,k=c.snowflakes[g].r,n=c.snowflakes[g].alpha;if(0<m||1==c.summer){m=1-m/o,k=c.snowflakes[g].r*m,n=c.snowflakes[g].alpha*m}k=0.1>k?0.1:k;n=0.1>n?0.1:n;c.snowflakes[g].x=c.snowflakes[g].x>c.w+c.snowflakes[g].r?0:c.snowflakes[g].x<-k?c.w:c.snowflakes[g].x;c.ctx.beginPath();c.ctx.arc(c.snowflakes[g].x,c.snowflakes[g].y,k,2*Math.PI,!1);c.ctx.fillStyle="rgba(255,255,255,"+n+")";c.ctx.fill()}}a(c)}})}function b(d){var e={};return e.delta=(d.particleSinus[0]+Math.random()*(d.particleSinus[1]-d.particleSinus[0]))*Math.round(2*Math.random()-1),e.r=d.particlaSize[0]+Math.random()*(d.particlaSize[1]-d.particlaSize[0]),e.alpha=d.particleOpacity[0]+Math.random()*(d.particleOpacity[1]-d.particleOpacity[0]),e.speed=(d.particleSpeed[0]+Math.random()*(d.particleSpeed[1]-d.particleSpeed[0]))*e.r/3,e.x=Math.random()*d.w,e.y=Math.random()*-d.h,e}i.fn.extend({letItSnow:function(c){var d={particleMaxPer:400,particlaSize:[0.2,6],particleOpacity:[0.3,1],particleSpeed:[30,100],particleSinus:[1,100]};return"destroy"!=c&&"stop"!=c&&"play"!=c&&"summer"!=c&&"winter"!=c&&(c=i.extend(!0,{},d,c)),this.each(function(){if(-1!=i.inArray(c,["destroy","stop","play","winter","summer"])){switch(c){case"destroy":c=i(this).data("snowflakes");c!=l&&h(c);break;case"stop":c=i(this).data("snowflakes");c!=l&&(c.pause=!0);break;case"play":c=i(this).data("snowflakes");c!=l&&(c.pause=!1,a(c));break;case"summer":c=i(this).data("snowflakes");c!=l&&(c.summer=!0);break;case"winter":c=i(this).data("snowflakes"),c!=l&&(c.summer=!1)}return !1}return c.c=i(this),c.sc=c.selector!=l?i(this).find(c.selector):c.c,0==c.sc.length?!1:c.c.data("snowflakes")!=l?!1:(c.sc.find(".snowflakes_wrapper").remove(),c.sc.append('<div class="snowflakes_wrapper" style="position:relative;z-index:0"><div class="snowflakes_wrapper_inner" style="overflow:hidden;position:relative"><canvas width="2700" height="2500" style="position:relative;" class="snowflake_canvas"></canvas></div></div>'),c.sw=c.sc.find(".snowflakes_wrapper_inner"),c.sw.data("caller_container",c.c),c.canvas=c.sc.find(".snowflake_canvas"),c.dimension!=self?c.sizer=c.c:c.sizer=c.sc,c.w=c.sizer.width(),c.h=c.sizer.height(),c.sc.find(".snowflakes_wrapper_inner").css({width:c.w,height:c.h}),c.canvas=c.canvas[0],c.snowflakes=[],c.ctx=c.canvas.getContext("2d"),j(c),a(c),c.c.data("snowflakes",c),void i(window).resize(function(){clearTimeout(c.timer);c.timer=setTimeout(function(){c.w=c.sizer.width();c.h=c.sizer.height();c.sc.find(".snowflakes_wrapper_inner").css({width:c.w,height:c.h});j(c)},50)}))})}})})(jQuery);